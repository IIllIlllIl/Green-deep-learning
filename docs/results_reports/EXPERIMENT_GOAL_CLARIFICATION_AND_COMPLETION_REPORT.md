# 实验目标澄清与完成度评估报告

**日期**: 2025-12-12
**版本**: v4.7.3  
**报告类型**: 实验目标重新定义与进度评估

---

## 📋 执行摘要

### 关键发现

🔴 **当前完成度**: **0.0%** (0/90组合完全达标)
✅ **部分完成**: 73.3% (66/90组合部分数据)
❌ **完全缺失**: 26.7% (24/90组合无数据)

### 需补齐实验数量

**总计**: **330个实验**
- 默认值实验: 90个
- 变异实验: 240个

### 主要问题

1. **性能数据缺失**: 128个实验缺少性能指标（26.9%）
   - 主要影响: examples/mnist_ff (56), VulBERTa/mlp (32), bug-localization (30), MRT-OAST (10)
2. **缺少默认值实验**: 所有90个组合都缺少默认值实验（100%）
3. **多参数变异实验**: 26个实验同时变异多个参数（需要重新运行单参数版本）
   - 4个参数变异: 18个
   - 5个参数变异: 8个

---

## 🎯 实验目标澄清

### 实验目标定义（重新澄清）

对于**45个超参数**，在**两种运行场景**（并行/非并行）下，都需要：

#### 1. 默认值实验
- **数量**: 每个超参数-模式组合1个
- **要求**: 不调用变异脚本，使用默认超参数值
- **目的**: 建立性能和能耗基线

#### 2. 单参数变异实验
- **数量**: 每个超参数-模式组合5个**唯一值**
- **要求**:
  - ✅ 每次实验**仅变异1个超参数**
  - ✅ 5次实验的超参数值**各不相同**（唯一性）
  - ❌ 不允许同时变异多个超参数
- **目的**: 研究单个超参数对能耗和性能的独立影响

#### 3. 数据完整性要求
- **能耗数据**: CPU和GPU能耗数据必须完整
- **性能数据**: 任意一个性能指标非空（accuracy, mAP, test_accuracy, test_loss, rank1等）
- **训练状态**: 训练必须成功完成

### 总实验目标

```
总组合数 = 45个超参数 × 2种模式 = 90个组合
每个组合需要 = 1个默认值 + 5个变异 = 6个实验
总实验数 = 90 × 6 = 540个实验
```

---

## 📊 当前状态分析

### 数据源

- **文件**: `data/raw_data.csv`
- **总实验数**: 476个
- **有效实验数**: 322个（67.6%）
- **无效实验数**: 154个（32.4%）

### 完成度统计

| 状态 | 组合数 | 百分比 | 说明 |
|------|--------|--------|------|
| **完全完成** | 0 | 0.0% | 有1个默认值 + 5个唯一变异 |
| **部分完成** | 66 | 73.3% | 有部分默认值或变异数据 |
| **完全缺失** | 24 | 26.7% | 完全没有有效数据 |
| **总计** | 90 | 100% | 所有组合 |

### 无效实验分析

**总无效实验**: 154个（占总实验的32.4%）

**无效原因分布**:

| 原因 | 数量 | 百分比 | 说明 |
|------|------|--------|------|
| 性能数据缺失 | 128 | 83.1% | 缺少所有性能指标 |
| 多参数变异（4个） | 18 | 11.7% | 同时变异4个参数 |
| 多参数变异（5个） | 8 | 5.2% | 同时变异5个参数 |
| **总计** | 154 | 100% | |

---

## 🔍 详细缺失分析

### 按模型分类

#### 1. 完全缺失模型（24个组合）

这些模型-参数-模式组合**完全没有有效数据**：

**examples/mnist_ff** (8个组合):
- 非并行: batch_size, epochs, learning_rate, seed（4个参数）
- 并行: batch_size, epochs, learning_rate, seed（4个参数）

**VulBERTa/mlp** (8个组合):
- 非并行: epochs, learning_rate, seed, weight_decay（4个）
- 并行: epochs, learning_rate, seed, weight_decay（4个）

**bug-localization-by-dnn-and-rvsm/default** (8个组合):
- 非并行: alpha, kfold, max_iter, seed（4个）
- 并行: alpha, kfold, max_iter, seed（4个）

**小计**: 3个模型 × 8个组合 = **24个完全缺失组合**

#### 2. 部分完成模型（66个组合）

这些组合有部分数据，但未达标：

**Person_reID_baseline_pytorch/densenet121**:
- 非并行（4个组合）:
  - 所有参数都有5个变异，但**缺少默认值实验**
- 并行（4个组合）:
  - 所有参数只有1个变异，需要补充**默认值 + 4个变异**

**Person_reID_baseline_pytorch/hrnet18**:
- 非并行（4个组合）:
  - dropout, learning_rate, seed: 5个变异，缺默认值
  - epochs: 4个变异，缺默认值 + 1个变异
- 并行（4个组合）:
  - 所有参数: 3个变异，缺默认值 + 2个变异

**Person_reID_baseline_pytorch/pcb**:
- 非并行（4个组合）:
  - learning_rate, seed: 5个变异，缺默认值
  - dropout, epochs: 4个变异，缺默认值 + 1个变异
- 并行（4个组合）:
  - 所有参数: 3个变异，缺默认值 + 2个变异

**MRT-OAST/default**:
- 非并行（5个组合）:
  - dropout: 4个变异，缺默认值 + 1个变异
  - epochs: 2个变异，缺默认值 + 3个变异
  - learning_rate, seed, weight_decay: 3个变异，缺默认值 + 2个变异
- 并行（5个组合）:
  - 所有参数: 1个变异，缺默认值 + 4个变异

**examples/mnist, mnist_rnn, siamese** (各有部分完成):
- 都有较多变异数据，主要缺少默认值和个别参数需要补齐

**pytorch_resnet_cifar10/resnet20**:
- 非并行: 多数参数已有5个变异，缺默认值
- 并行: 只有1个变异，需要补齐

**小计**: **66个部分完成组合**

---

## 📈 需补齐实验详细清单

### 默认值实验（90个）

**每个模型-参数-模式组合都需要1个默认值实验**

| 模型 | 参数数 | 模式 | 需补齐 |
|------|--------|------|--------|
| examples/mnist | 4 | 2 | 8 |
| examples/mnist_rnn | 4 | 2 | 8 |
| examples/mnist_ff | 4 | 2 | 8 |
| examples/siamese | 4 | 2 | 8 |
| Person_reID/densenet121 | 4 | 2 | 8 |
| Person_reID/hrnet18 | 4 | 2 | 8 |
| Person_reID/pcb | 4 | 2 | 8 |
| VulBERTa/mlp | 4 | 2 | 8 |
| resnet20 | 4 | 2 | 8 |
| MRT-OAST/default | 5 | 2 | 10 |
| bug-localization/default | 4 | 2 | 8 |
| **总计** | **45** | **2** | **90** |

### 变异实验（240个）

按需补齐数量分组：

| 需补齐数量 | 组合数 | 总实验数 | 说明 |
|-----------|--------|----------|------|
| 5个变异 | 24 | 120 | 完全缺失组合 |
| 4个变异 | 30 | 120 | 只有1个变异的组合 |
| 2个变异 | 12 | 24 | 只有3个变异的组合 |
| 1个变异 | 8 | 8 | 只有4个变异的组合 |
| **总计** | **74** | **272** | |

**实际需要**: 240个变异实验（基于实际缺失情况）

---

## 🎯 实验补齐策略

### 优先级分类

#### 第一优先级：性能数据缺失调查（128个实验）

**问题**: 这些实验已经运行，但缺少性能数据

**主要影响模型**:
- examples/mnist_ff: 56个（全部缺失）
- VulBERTa/mlp: 32个（全部缺失）
- bug-localization: 30个（全部缺失）
- MRT-OAST: 10个（部分缺失）

**原因分析**:
1. 这些实验的性能指标提取可能有问题
2. 某些模型可能使用了不同的性能指标命名
3. 日志格式可能不兼容当前的提取脚本

**建议**:
- 先抽样检查几个实验的原始日志
- 确定是否可以重新提取性能数据
- 如果无法提取，则需要重新运行这些实验

#### 第二优先级：多参数变异修正（26个实验）

**问题**: 26个实验同时变异了多个参数

**影响**: 无法分析单个参数的独立影响

**解决方案**:
1. 将这26个实验标记为"多参数变异研究"
2. 为这些参数-模式组合重新运行单参数变异实验
3. 每个组合需要1个默认值 + 5个单参数变异 = 6个实验
4. 但由于有些组合可能已有部分数据，实际需要补齐的会少于156个

#### 第三优先级：补齐缺失实验（330个）

**分阶段执行**:

1. **阶段1**: 默认值实验（90个）
   - 简单、快速
   - 建立所有组合的基线
   - 优先级最高

2. **阶段2**: 快速模型变异补齐（约150个）
   - examples/mnist系列（已有部分数据，主要补齐）
   - 这些模型训练快速，可以快速补齐

3. **阶段3**: 中速模型变异补齐（约90个）
   - Person_reID系列（已有较多数据，主要补默认值和少量变异）
   - resnet20（已有较多数据）
   - MRT-OAST（需要补齐一些）

4. **阶段4**: 性能数据缺失模型重新运行（如需要）
   - examples/mnist_ff: 56个
   - VulBERTa/mlp: 32个
   - bug-localization: 30个

### 预估时间

基于历史数据（238.51小时完成476个实验，平均30分钟/实验）:

| 阶段 | 实验数 | 预估时间 |
|------|--------|----------|
| 默认值补齐 | 90 | 45小时 |
| 快速模型变异补齐 | 150 | 75小时 |
| 中速模型变异补齐 | 90 | 45小时 |
| 性能缺失模型重运行（如需要） | 118 | 59小时 |
| **总计** | **330-448** | **165-224小时** |

**注意**: 如果能够从日志重新提取性能数据，可以节省118个实验（59小时）

---

## 🚨 关键问题与建议

### 1. 性能数据缺失问题

**严重性**: 🟡 中（之前认为高，但实际影响有限）

**影响**: 26.9%的实验缺少性能数据

**分析**:
- 主要集中在3个模型（mnist_ff, VulBERTa/mlp, bug-localization）
- 这些模型可能使用不同的性能指标或日志格式
- 不影响其他8个模型的数据完整性

**建议**:
1. 抽样检查5-10个缺失实验的原始日志文件
2. 查看这些模型的训练脚本，确认使用的性能指标命名
3. 如果可以修复提取逻辑，可以节省大量重新运行时间
4. 如果无法修复，则将这些模型的实验标记为需要重新运行

### 2. 缺少默认值实验

**严重性**: 🔴 高

**影响**: 100%的组合缺少基线

**分析**:
- 所有90个组合都没有默认值实验
- 这意味着之前的实验计划完全专注于变异研究
- 没有基线就无法评估变异的实际影响

**建议**:
1. **立即优先**运行90个默认值实验
2. 默认值实验相对简单快速（约45小时）
3. 完成后可以开始有意义的对比分析
4. 这是最高优先级的任务

### 3. 多参数变异问题

**严重性**: ⚠️ 低（数量少）

**影响**: 26个实验数据不符合单参数研究目标

**建议**:
1. 这些多参数变异实验可以保留用于未来的交互效应研究
2. 优先补齐对应的单参数实验
3. 不需要删除这些数据，只需补充单参数版本

### 4. 实验规模重估

**当前状态**: 476个实验，67.6%有效（322个）

**目标状态**: 540个有效实验（90组合 × 6实验/组合）

**实际差距**: 需要补齐**218-330个实验**
- 最优情况（能修复性能数据）: 218个实验
- 最坏情况（需要重新运行）: 330个实验

**时间预估**:
- 最优情况: 109小时（约4.5天）
- 最坏情况: 165小时（约7天）

---

## 📝 后续行动计划

### 立即行动（1-2天）

1. ✅ **澄清实验目标** - 本文档已完成
2. ✅ **修正分析脚本** - 已更新性能数据验证逻辑
3. ⏳ **调查性能数据缺失原因**
   - 抽样检查mnist_ff, VulBERTa/mlp, bug-localization的日志文件
   - 查看这些模型的性能指标提取逻辑
   - 确定是否可以修复

### 短期行动（1周）

4. **运行默认值实验**（90个，约45小时）
   - 为所有45个参数在两种模式下运行默认值基线
   - 这是最高优先级任务

5. **创建补齐配置文件**
   - 基于experiment_completion_report.json生成配置
   - 分为3个阶段：默认值、快速模型、慢速模型

### 中期行动（2-3周）

6. **运行快速模型变异补齐**（约150个，约75小时）
   - examples/mnist系列
   - 其他已有部分数据的快速模型

7. **运行中速模型变异补齐**（约90个，约45小时）
   - Person_reID系列
   - resnet20
   - MRT-OAST

8. **处理性能缺失模型**（视调查结果而定）
   - 如果能修复提取逻辑：重新提取数据
   - 如果无法修复：重新运行118个实验（59小时）

### 验证与总结

9. **重新运行完成度分析**
10. **验证所有540个实验达标**
11. **生成最终实验报告**

---

## 📊 附录：详细数据

### A. 45个模型-参数组合明细

| 模型 | 参数列表 |
|------|----------|
| examples/mnist | batch_size, epochs, learning_rate, seed |
| examples/mnist_rnn | batch_size, epochs, learning_rate, seed |
| examples/mnist_ff | batch_size, epochs, learning_rate, seed |
| examples/siamese | batch_size, epochs, learning_rate, seed |
| Person_reID_baseline_pytorch/densenet121 | dropout, epochs, learning_rate, seed |
| Person_reID_baseline_pytorch/hrnet18 | dropout, epochs, learning_rate, seed |
| Person_reID_baseline_pytorch/pcb | dropout, epochs, learning_rate, seed |
| VulBERTa/mlp | epochs, learning_rate, seed, weight_decay |
| pytorch_resnet_cifar10/resnet20 | epochs, learning_rate, seed, weight_decay |
| MRT-OAST/default | dropout, epochs, learning_rate, seed, weight_decay |
| bug-localization-by-dnn-and-rvsm/default | alpha, kfold, max_iter, seed |

**总计**: 45个参数（每个参数在2种模式下 = 90个组合）

### B. 数据完整性要求

**必需字段**:

1. **训练状态**: `training_success` = "True"
2. **能耗数据**:
   - 非并行: `energy_cpu_total_joules`, `energy_gpu_total_joules`
   - 并行: `fg_energy_cpu_total_joules`, `fg_energy_gpu_total_joules`
3. **性能数据**（至少一个非空）:
   - 所有性能指标列: `perf_accuracy`, `perf_best_val_accuracy`, `perf_map`, `perf_precision`, `perf_rank1`, `perf_rank5`, `perf_recall`, `perf_test_accuracy`, `perf_test_loss`
   - 并行模式: 对应的`fg_`前缀版本

### C. 变异要求

**单参数变异**:
- `num_mutated_params` = 1
- `mutated_param` 字段指明变异的参数

**唯一性**:
- 同一参数的5个变异实验值必须各不相同
- 通过超参数值去重验证

---

**报告版本**: 1.1
**生成时间**: 2025-12-12 (更新)
**数据源**: data/raw_data.csv (476行)
**分析脚本**: scripts/analyze_experiment_completion.py（已更新性能数据验证逻辑）
