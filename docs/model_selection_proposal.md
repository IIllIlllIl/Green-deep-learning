# 变异实验模型选择方案

**目标**: 研究有实际价值的模型的超参数-能耗关系
**日期**: 2025-11-10
**基于数据**: 12模型快速测试 + Full Test Run

---

## 数据基础

### 现有模型性能总结 (Full Test Run - 完整训练)

| 模型 | 训练时长 | 性能指标 | 状态 | 研究价值 |
|------|---------|---------|------|---------|
| **ResNet20** (200 epochs) | 19.8分钟 | **91.45%** Acc | ✅ | **高** - SOTA水平 |
| **Person_reID/densenet121** (60 epochs) | 38分钟 | **90.11%** Rank@1, **74.59%** mAP | ✅ | **高** - 优秀ReID |
| **MRT-OAST** (10 epochs) | 42分钟 | **90.10%** Acc, **88.78%** F1 | ✅ | **高** - 优秀分类 |
| **VulBERTa/mlp** (10 epochs) | 55分钟 | 训练成功，loss收敛 | ✅ | **中** - 需验证性能 |
| **examples/mnist** (10 epochs) | 1.5分钟 | **99.0%** Acc | ✅ | **中** - 简单任务 |
| **bug-localization** (max_iter=10000) | ~2.6小时 | Top-1: 82.8% | ✅ | **中** - 时间太长 |

### 快速测试能耗数据 (1 epoch baseline)

| 模型 | 1 epoch时长 | 1 epoch能耗 | 性能指标 (1 epoch) |
|------|------------|------------|------------------|
| ResNet20 | 18.3秒 | 2.50 kJ | - |
| ResNet32 | 19.8秒 | 2.99 kJ | - |
| ResNet44 | 21.9秒 | 3.57 kJ | - |
| ResNet56 | 25.1秒 | 4.43 kJ | - |
| Person_reID/densenet121 | 123秒 | 26.81 kJ | 64.9% Rank@1 (未收敛) |
| Person_reID/hrnet18 | 58.9秒 | 2.50 kJ | - |
| Person_reID/pcb | 205秒 | 54.63 kJ | - |
| MRT-OAST | 165秒 | 42.42 kJ | - |
| examples/mnist | 19.5秒 | 2.05 kJ | 93% Acc |

---

## 方案一：精英模型 (推荐 - 性能导向)

### 选择标准
- ✅ 性能达到SOTA或接近SOTA水平
- ✅ 训练成功且稳定
- ✅ 训练时间可控 (< 1小时/次)
- ✅ 有实际应用价值

### 推荐模型：3个核心模型

#### 1. pytorch_resnet_cifar10/resnet20 ⭐⭐⭐
**选择理由**:
- 性能优秀: 91.45% (CIFAR-10 SOTA约93-95%)
- 训练高效: 200 epochs仅20分钟
- 能耗可控: 1 epoch仅2.5 kJ
- 经典模型: ResNet在CV领域广泛使用
- 变异空间大: epochs [100, 400], lr [0.01, 1.0]

**变异计划**: 20-30个变异点
- 预计时间: 200 epochs × 20次 × 20分钟 = 6.7小时
- 预计能耗: 2.5 kJ/epoch × 200 × 20 = 10 MJ

#### 2. Person_reID_baseline_pytorch/densenet121 ⭐⭐⭐
**选择理由**:
- 性能优秀: 90.11% Rank@1, 74.59% mAP
- 实际应用: 行人重识别是重要CV任务
- 训练时间适中: 60 epochs约38分钟
- 能耗中等: 1 epoch约27 kJ
- ReID任务的代表性

**变异计划**: 15-20个变异点
- 预计时间: 60 epochs × 15次 × 38分钟 = 9.5小时
- 预计能耗: 27 kJ/epoch × 60 × 15 = 24.3 MJ

#### 3. MRT-OAST/default ⭐⭐
**选择理由**:
- 性能优秀: 90.10% Acc, 88.78% F1
- 多指标: Accuracy, Precision, Recall, F1全面评估
- 训练时间可控: 10 epochs约42分钟
- NLP/文本分类代表性

**变异计划**: 15个变异点
- 预计时间: 10 epochs × 15次 × 42分钟 = 10.5小时
- 预计能耗: 42 kJ × 15 = 630 kJ

### 方案一总结

| 指标 | 数值 |
|------|------|
| **模型数量** | 3个 (CV×2 + NLP×1) |
| **总变异点** | 50-65个 |
| **预计总时长** | 26.7小时 (约1.1天) |
| **预计总能耗** | ~35 MJ |
| **任务覆盖** | 图像分类, 行人重识别, 文本分类 |
| **研究价值** | **高** - 所有模型性能优秀 |

---

## 方案二：高效覆盖 (平衡性能与多样性)

### 选择标准
- ✅ 性能合格 (>85% Acc / >80% Rank@1)
- ✅ 训练快速 (< 30分钟/次)
- ✅ 任务多样性
- ✅ 能耗分布均衡

### 推荐模型：5个模型

#### 核心3个 (方案一)
1. **pytorch_resnet_cifar10/resnet20** (CV分类)
2. **Person_reID_baseline_pytorch/densenet121** (ReID)
3. **MRT-OAST/default** (NLP分类)

#### 新增2个

#### 4. examples/mnist ⭐
**选择理由**:
- 性能完美: 99.0% Acc
- 极快训练: 10 epochs仅1.5分钟
- 低能耗: 1 epoch仅2 kJ
- 基线模型: 适合快速验证变异策略

**变异计划**: 30个变异点 (低成本高通量)
- 预计时间: 10 epochs × 30次 × 1.5分钟 = 7.5小时
- 预计能耗: 2 kJ/epoch × 10 × 30 = 600 kJ

#### 5. Person_reID_baseline_pytorch/hrnet18 ⭐
**选择理由**:
- 轻量级ReID: 对比densenet121
- 训练快速: 1 epoch仅59秒
- 低能耗: 1 epoch仅2.5 kJ
- 多模型对比: 同任务不同架构

**变异计划**: 20个变异点
- 预计时间: 60 epochs × 20次 × 59秒 = 19.7小时
- 预计能耗: 2.5 kJ/epoch × 60 × 20 = 3 MJ

### 方案二总结

| 指标 | 数值 |
|------|------|
| **模型数量** | 5个 (CV×3 + NLP×1 + 轻量×1) |
| **总变异点** | 100-115个 |
| **预计总时长** | 53.9小时 (约2.2天) |
| **预计总能耗** | ~39 MJ |
| **任务覆盖** | 图像分类×2, ReID×2, 文本分类 |
| **研究价值** | **中高** - 性能优秀且多样性好 |

---

## 方案三：ResNet系列深度研究 (单任务多模型)

### 选择标准
- ✅ 同任务不同深度
- ✅ 控制变量: 只有模型深度变化
- ✅ 系统性研究深度-能耗关系

### 推荐模型：4个ResNet模型

#### 1. pytorch_resnet_cifar10/resnet20 ⭐⭐⭐
- 性能: 91.45% Acc (已验证)
- 1 epoch: 18.3秒, 2.50 kJ
- 层数: 20层

#### 2. pytorch_resnet_cifar10/resnet32 ⭐⭐
- 性能: 预期~92%
- 1 epoch: 19.8秒, 2.99 kJ
- 层数: 32层

#### 3. pytorch_resnet_cifar10/resnet44 ⭐⭐
- 性能: 预期~92.5%
- 1 epoch: 21.9秒, 3.57 kJ
- 层数: 44层

#### 4. pytorch_resnet_cifar10/resnet56 ⭐
- 性能: 预期~93%
- 1 epoch: 25.1秒, 4.43 kJ
- 层数: 56层

### 变异计划

**每个模型**: 15个变异点
- 主要变异: epochs [100, 400], lr [0.01, 1.0], wd [1e-5, 0.01]
- 种子固定: 评估深度影响

### 方案三总结

| 指标 | 数值 |
|------|------|
| **模型数量** | 4个 (ResNet系列) |
| **总变异点** | 60个 |
| **预计总时长** | ~60小时 (约2.5天) |
| **预计总能耗** | ~60 MJ |
| **任务覆盖** | 图像分类 (深度对比) |
| **研究价值** | **专精** - 深度系统性研究 |

**独特价值**:
- 研究模型深度对能耗的影响
- 识别最优深度-性能-能耗平衡点
- 控制变量的科学性强

---

## 方案对比与推荐

### 三方案对比表

| 维度 | 方案一: 精英模型 | 方案二: 高效覆盖 | 方案三: ResNet深度 |
|------|-----------------|-----------------|-------------------|
| **模型数量** | 3个 | 5个 | 4个 |
| **变异点数** | 50-65 | 100-115 | 60 |
| **总时长** | 26.7h (1.1天) | 53.9h (2.2天) | 60h (2.5天) |
| **总能耗** | ~35 MJ | ~39 MJ | ~60 MJ |
| **任务多样性** | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐ |
| **性能水平** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| **研究深度** | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| **时间成本** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ |
| **科学价值** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

### 推荐建议

#### 🥇 **首选: 方案一 (精英模型)**

**适合场景**:
- 时间有限 (1-2天可完成)
- 希望快速出结果
- 关注实际应用价值

**优势**:
- 所有模型性能优秀 (90%+)
- 时间最短 (1.1天)
- 能耗适中
- 任务覆盖CV和NLP

**缺点**:
- 样本量相对较少 (50-65点)

---

#### 🥈 **次选: 方案二 (高效覆盖)**

**适合场景**:
- 时间充足 (2-3天)
- 希望研究多种模型类型
- 需要更多数据点

**优势**:
- 模型多样性最高
- 数据点最多 (100-115点)
- 覆盖轻量级和重量级模型

**缺点**:
- 时间较长 (2.2天)
- 部分模型性能未充分验证

---

#### 🥉 **特选: 方案三 (ResNet深度)**

**适合场景**:
- 专注单一任务的系统性研究
- 研究模型架构对能耗的影响
- 撰写深度研究论文

**优势**:
- 控制变量严格
- 科学性最强
- 可得出深度-能耗曲线

**缺点**:
- 任务单一 (仅图像分类)
- 时间最长 (2.5天)
- 能耗最高

---

## 实施建议

### 分阶段实施策略

#### 阶段1: 快速验证 (0.5天)
```bash
# 仅使用ResNet20 + 10个变异点
python3 mutation.py -r pytorch_resnet_cifar10 -m resnet20 \
                    -mt epochs,learning_rate,weight_decay \
                    -n 10 -g performance
```

**目的**: 验证变异策略是否有效

#### 阶段2: 核心模型 (1-2天)
- 实施方案一的3个核心模型
- 各15-30个变异点

#### 阶段3: 扩展 (可选)
- 根据阶段2结果决定是否扩展到方案二或方案三

---

## 排除的模型及原因

| 模型 | 排除原因 |
|------|---------|
| **VulBERTa/cnn** | 不实际训练，仅placeholder |
| **VulBERTa/mlp** | 性能未明确验证，训练时间长(55分钟) |
| **bug-localization** | 训练时间过长(2.6小时)，单次成本太高 |
| **Person_reID/pcb** | 1 epoch能耗过高(54.63 kJ)，效率低 |

---

## 最终推荐

### 🎯 综合推荐: **方案一 (3个精英模型)**

**具体配置**:

1. **pytorch_resnet_cifar10/resnet20**: 25个变异点
   - 变异参数: epochs, learning_rate, weight_decay
   - 预计8小时

2. **Person_reID_baseline_pytorch/densenet121**: 15个变异点
   - 变异参数: epochs, learning_rate, dropout
   - 预计9.5小时

3. **MRT-OAST/default**: 15个变异点
   - 变异参数: epochs, learning_rate, weight_decay, dropout
   - 预计10.5小时

**总计**: 55个变异点, 28小时 (约1.2天)

**研究产出**:
- 3种任务类型的超参数-能耗关系
- 55个完整的训练-能耗-性能数据点
- 可绘制帕累托前沿图
- 足够发表研究论文

---

## 配置文件示例

创建 `settings/mutation_experiment_elite.json`:

```json
{
  "experiment_name": "mutation_elite_models",
  "description": "Elite models mutation experiment - Phase 2",
  "mode": "mutation",
  "governor": "performance",
  "runs_per_config": 25,
  "max_retries": 2,
  "experiments": [
    {
      "repo": "pytorch_resnet_cifar10",
      "model": "resnet20",
      "mutate": ["epochs", "learning_rate", "weight_decay"]
    },
    {
      "repo": "Person_reID_baseline_pytorch",
      "model": "densenet121",
      "mutate": ["epochs", "learning_rate", "dropout"]
    },
    {
      "repo": "MRT-OAST",
      "model": "default",
      "mutate": ["epochs", "learning_rate", "weight_decay", "dropout"]
    }
  ]
}
```

**启动命令**:
```bash
screen -S mutation_elite
python3 mutation.py -ec settings/mutation_experiment_elite.json
```

---

**文档生成**: 2025-11-10
**状态**: 待用户选择
