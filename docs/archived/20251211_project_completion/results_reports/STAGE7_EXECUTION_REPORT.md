# Stage7 执行报告

**配置文件**: `settings/stage7_nonparallel_fast_models.json`
**执行时间**: 2025-12-05 21:17 - 22:02
**报告生成**: 2025-12-06
**版本**: v4.6.1

---

## 📊 执行摘要

### 配置预期 vs 实际结果

| 指标 | 配置预期 | 实际结果 | 差异 |
|------|---------|---------|------|
| **实验数量** | 199个 | 7个 | -192个 (-96.5%) |
| **运行时长** | 38.3小时 | 0.74小时 | -37.6小时 (-98.1%) |
| **成功率** | - | 100% (7/7) | ✅ |
| **总实验数** | 381→580 | 381→388 | +7个 |

### 关键发现

**🎯 去重机制高效运行**
- **跳过率**: 96.5% (192/199个实验被跳过)
- **节省时间**: 约37.6小时
- **原因**: Stage7目标参数在Stage1-4中已基本达成

**✅ 数据质量验证通过**
- CSV格式: ✓ 37列标准格式
- 能耗数据: ✓ 所有7个实验CPU/GPU数据完整
- 训练成功: ✓ 100%成功率

---

## 🔬 详细分析

### 1. 新增实验列表

| # | 实验ID | 模型 | 时长(分钟) | 关键参数 |
|---|--------|------|-----------|---------|
| 1 | examples_mnist_001 | examples/mnist | 2.9 | epochs=13, lr=0.012, bs=62 |
| 2 | examples_mnist_ff_002 | examples/mnist_ff | 0.1 | epochs=5, lr=0.010, bs=127 |
| 3 | examples_mnist_rnn_003 | examples/mnist_rnn | 1.5 | epochs=5, lr=0.009, bs=76 |
| 4 | examples_siamese_004 | examples/siamese | 1.8 | epochs=6, lr=0.015, bs=58 |
| 5 | MRT-OAST_default_005 | MRT-OAST/default | 13.0 | epochs=6, lr=9.4e-05, seed=3775 |
| 6 | bug-localization_006 | bug-loc/default | 6.6 | max_iter=11879, kfold=5, seed=1520 |
| 7 | resnet20_007 | resnet_cifar10/resnet20 | 12.2 | epochs=127, lr=0.125, seed=7666 |

**总时长**: 44.4分钟 (实际0.74小时包含系统开销)

### 2. 各模型当前状态

#### 2.1 examples/mnist
- **总实验数**: 35个 (21非并行 + 14并行)
- **参数唯一值**:
  - batch_size: 7个 ✅
  - epochs: 7个 ✅
  - learning_rate: 11个 ✅ 超额完成
  - seed: 11个 ✅ 超额完成
- **Stage7贡献**: +1个非并行实验

#### 2.2 examples/mnist_ff
- **总实验数**: 34个 (26非并行 + 8并行)
- **参数唯一值**:
  - batch_size: 8个 ✅ 超额完成
  - epochs: 6个 ✅ 接近目标
  - learning_rate: 9个 ✅ 超额完成
  - seed: 9个 ✅ 超额完成
- **Stage7贡献**: +1个非并行实验

#### 2.3 examples/mnist_rnn
- **总实验数**: 35个 (21非并行 + 14并行)
- **参数唯一值**:
  - batch_size: 7个 ✅
  - epochs: 8个 ✅ 超额完成
  - learning_rate: 11个 ✅ 超额完成
  - seed: 11个 ✅ 超额完成
- **Stage7贡献**: +1个非并行实验

#### 2.4 examples/siamese
- **总实验数**: 35个 (21非并行 + 14并行)
- **参数唯一值**:
  - batch_size: 7个 ✅
  - epochs: 9个 ✅ 超额完成
  - learning_rate: 11个 ✅ 超额完成
  - seed: 11个 ✅ 超额完成
- **Stage7贡献**: +1个非并行实验

#### 2.5 MRT-OAST/default
- **总实验数**: 50个 (29非并行 + 21并行)
- **参数唯一值**:
  - dropout: 12个 ✅ 超额完成
  - epochs: 7个 ✅
  - learning_rate: 11个 ✅ 超额完成
  - seed: 11个 ✅ 超额完成
  - weight_decay: 11个 ✅ 超额完成
- **Stage7贡献**: +1个非并行实验

#### 2.6 bug-localization-by-dnn-and-rvsm/default
- **总实验数**: 35个 (21非并行 + 14并行)
- **参数唯一值**:
  - alpha: 11个 ✅ 超额完成
  - kfold: 6个 ✅ 接近目标
  - max_iter: 11个 ✅ 超额完成
  - seed: 11个 ✅ 超额完成
- **Stage7贡献**: +1个非并行实验

#### 2.7 pytorch_resnet_cifar10/resnet20
- **总实验数**: 39个 (22非并行 + 17并行)
- **参数唯一值**:
  - epochs: 10个 ✅ 超额完成
  - learning_rate: 11个 ✅ 超额完成
  - seed: 11个 ✅ 超额完成
  - weight_decay: 11个 ✅ 超额完成
- **Stage7贡献**: +1个非并行实验

---

## 📈 能耗数据分析

### CPU能耗 (Package + RAM)

| 实验 | CPU包能耗(J) | RAM能耗(J) | 总计(J) |
|------|-------------|-----------|---------|
| mnist_001 | 5,331.68 | 409.83 | 5,741.51 |
| mnist_ff_002 | 205.31 | 16.97 | 222.28 |
| mnist_rnn_003 | 3,159.02 | 215.67 | 3,374.69 |
| siamese_004 | 3,418.90 | 256.84 | 3,675.74 |
| MRT-OAST_005 | 23,124.13 | 1,775.62 | 24,899.75 |
| bug-loc_006 | 25,124.17 | 956.90 | 26,081.07 |
| resnet20_007 | 30,899.66 | 1,915.74 | 32,815.40 |
| **总计** | **91,262.87** | **5,547.57** | **96,810.44** |

### GPU能耗

| 实验 | 平均功率(W) | 总能耗(J) | 平均温度(°C) | 平均利用率(%) |
|------|------------|----------|------------|-------------|
| mnist_001 | 90.18 | 14,969.06 | 52.60 | 9.30 |
| mnist_ff_002 | 77.98 | 467.89 | 51.83 | 0.50 |
| mnist_rnn_003 | 17.41 | 1,445.30 | 45.58 | 0.00 |
| siamese_004 | 168.30 | 17,502.70 | 61.03 | 50.73 |
| MRT-OAST_005 | 268.01 | 202,077.84 | 79.09 | 91.84 |
| bug-loc_006 | 76.22 | 13,415.33 | 59.24 | 0.26 |
| resnet20_007 | 227.78 | 161,265.19 | 77.75 | 59.29 |
| **总计** | **132.27** (平均) | **411,143.31** | **61.02** (平均) | **30.27** (平均) |

### 能耗关键观察

1. **GPU利用率差异大**: 从0% (mnist_rnn) 到91.84% (MRT-OAST)
   - mnist_ff、mnist_rnn、bug-loc几乎不使用GPU (CPU为主)
   - MRT-OAST、resnet20、siamese高度依赖GPU

2. **总能耗**:
   - CPU总计: 96.8 kJ (26.9 Wh)
   - GPU总计: 411.1 kJ (114.2 Wh)
   - GPU能耗占比: 80.9%

3. **能效比**:
   - mnist_ff最高效: 0.1分钟, 690.17 J
   - MRT-OAST能耗最大: 13.0分钟, 226,977.59 J

---

## ✅ 验证结果

### CSV格式验证
```
✓ Header有37列
✓ 所有数据行正确对齐
✓ 无列不匹配错误
✓ 自动追加到summary_all.csv成功
```

### 能耗数据完整性
```
✓ 7/7 实验有完整的CPU能耗数据
✓ 7/7 实验有完整的GPU能耗数据
✓ 所有温度、功率、利用率数据齐全
```

### 训练成功率
```
✓ 7/7 实验训练成功
✓ 0次重试
✓ 100%成功率
```

---

## 🎯 结论与建议

### 主要结论

1. **Stage7目标已基本达成**
   所有7个模型在非并行模式下的关键参数都已达到或超过5个唯一值的目标。

2. **去重机制运行完美**
   96.5%的跳过率证明了历史数据去重的有效性，避免了大量重复实验。

3. **数据质量优秀**
   所有新增实验的数据完整性、能耗监控、CSV格式都符合标准。

4. **分阶段计划有效**
   Stage1-4的执行为Stage7打下了良好基础，证明了分阶段策略的合理性。

### 下一步建议

#### 选项A: 跳过Stage8-10，直接执行Stage11-13
**理由**:
- Stage8-10也是非并行模式，可能会遇到类似的高跳过率
- Stage11-13是并行模式补充，更可能产生新的唯一值
- 节省验证时间，直接聚焦高价值实验

**风险**:
- 可能遗漏少数非并行模式下的边缘参数组合

#### 选项B: 快速验证Stage8
**理由**:
- Stage8是非并行中慢速模型，执行时间相对较短(35.1h)
- 如果跳过率同样很高，可以快速确认并跳过Stage9-10
- 为后续决策提供更多数据

#### 选项C: 按计划执行Stage8-13
**理由**:
- 完整性最高，确保不遗漏任何参数组合
- 去重机制会自动跳过重复实验，时间成本可控

### 推荐方案

**推荐选项B**: 快速验证Stage8

1. 先执行Stage8，预计实际时间远低于35.1小时（预计<1小时）
2. 根据Stage8的跳过率决定：
   - 若跳过率>90%: 跳过Stage9-10，直接执行Stage11-13
   - 若跳过率<90%: 继续执行Stage9-10
3. 最终执行Stage11-13完成并行模式补充

---

## 📋 附录

### A. 配置文件信息
```json
{
  "comment": "Stage7: 非并行模式快速和中速模型",
  "version": "4.6.0",
  "estimated_duration_hours": 38.3,
  "estimated_experiments": 199,
  "use_deduplication": true,
  "historical_csvs": ["results/summary_all.csv"]
}
```

### B. 执行环境
- **运行命令**: `sudo -E python3 mutation.py -ec settings/stage7_nonparallel_fast_models.json`
- **Screen会话**: test (2743527.test)
- **系统**: Linux dell-PowerEdge-T640
- **Python**: 3.x (base conda环境)
- **GPU**: NVIDIA (nvidia-smi可用)

### C. 相关文件
- 配置文件: `settings/stage7_nonparallel_fast_models.json`
- Session结果: `results/run_20251205_211726/summary.csv`
- 全局汇总: `results/summary_all.csv` (388行)
- 分析脚本: `scripts/analyze_stage7_results.py`
- 验证测试: `tests/verify_csv_append_fix.py`

---

**报告生成**: 2025-12-06
**作者**: Automated Analysis
**状态**: ✅ Stage7执行成功，建议执行Stage8验证
