# Parallel Training éªŒè¯æŠ¥å‘Š

**æ—¥æœŸ**: 2025-11-15
**æµ‹è¯•é…ç½®**: settings/parallel_feasibility_test.json
**æ€»å®éªŒæ•°**: 12ä¸ª
**è¿è¡Œç›®å½•**: results/run_20251115_165340/

---

## âœ… é—®é¢˜1: å‰æ™¯æ¨¡å‹å’ŒèƒŒæ™¯æ¨¡å‹æ˜¯å¦éƒ½è¿è¡ŒæˆåŠŸ

### ç»“è®º: **éƒ¨åˆ†æˆåŠŸ**

#### Foreground (å‰æ™¯) è®­ç»ƒ: **100% æˆåŠŸ** âœ…

æ‰€æœ‰12ä¸ªforegroundè®­ç»ƒå…¨éƒ¨æˆåŠŸå®Œæˆï¼š

| å®éªŒ | Foregroundæ¨¡å‹ | çŠ¶æ€ | æ—¶é•¿ | experiment.json |
|------|---------------|------|------|-----------------|
| 1 | examples/mnist_ff | âœ… | 8.7s | âœ… å®Œæ•´ |
| 2 | examples/mnist | âœ… | 21.2s | âœ… å®Œæ•´ |
| 3 | examples/mnist | âœ… | 19.9s | âœ… å®Œæ•´ |
| 4 | examples/mnist_rnn | âœ… | 29.4s | âœ… å®Œæ•´ |
| 5 | examples/mnist_rnn | âœ… | 27.7s | âœ… å®Œæ•´ |
| 6 | examples/mnist_rnn | âœ… | 28.0s | âœ… å®Œæ•´ |
| 7 | VulBERTa/mlp | âœ… | 374.8s | âœ… å®Œæ•´ |
| 8 | examples/siamese | âœ… | 49.4s | âœ… å®Œæ•´ |
| 9 | Person_reID/pcb | âœ… | 262.4s | âœ… å®Œæ•´ |
| 10 | examples/mnist_ff | âœ… | 9.0s | âœ… å®Œæ•´ |
| 11 | Person_reID/pcb | âœ… | 2178.5s | âœ… å®Œæ•´ |
| 12 | Person_reID/densenet121 | âœ… | 155.3s | âœ… å®Œæ•´ |

**éªŒè¯ç»“æœ**:
- âœ… æ‰€æœ‰foregroundè®­ç»ƒæˆåŠŸå®Œæˆ
- âœ… æ‰€æœ‰experiment.jsonæ–‡ä»¶å®Œæ•´ç”Ÿæˆ
- âœ… èƒ½è€—æ•°æ®å®Œæ•´ï¼ˆCPU + GPUï¼‰
- âœ… æ€§èƒ½æŒ‡æ ‡æ­£ç¡®æå–

#### Background (èƒŒæ™¯) è®­ç»ƒ: **æœ‰é—®é¢˜** âš ï¸

**é—®é¢˜åˆ†ç±»**:

1. **æˆåŠŸæ¡ˆä¾‹** (11ä¸ª): ResNetç³»åˆ— + Person_reIDæ¨¡å‹
   - pytorch_resnet_cifar10/resnet20/32/44/56 âœ…
   - Person_reID/densenet121/hrnet18 âœ…
   - å®é™…è¿è¡Œè®­ç»ƒå¹¶äº§ç”ŸGPUè´Ÿè½½

2. **å¤±è´¥æ¡ˆä¾‹** (1ä¸ª): VulBERTa-CNN âŒ
   - **é—®é¢˜**: VulBERTa-CNNæœªå®ç°
   - **å½±å“**: 103æ¬¡åå°"è®­ç»ƒ"ï¼Œæ¯æ¬¡ä»…1ç§’ï¼ˆæ— å®é™…GPUè´Ÿè½½ï¼‰
   - **æ—¥å¿—**: "CNN training not yet implemented"
   - **å®é™…æ•ˆæœ**: å‰æ™¯è®­ç»ƒæ²¡æœ‰çœŸå®çš„GPUè´Ÿè½½æµ‹è¯•

**è¯¦ç»†æ¡ˆä¾‹åˆ†æ**:

### æ¡ˆä¾‹1: examples_mnist_ff (å®éªŒ1) âœ… æˆåŠŸ

**Background**: pytorch_resnet_cifar10/resnet20

```
Run 1: 16:53:40 - 16:53:51 (11ç§’) âœ… å®Œæˆ
Run 2: 16:53:59 - 16:54:10 (11ç§’) âœ… å®Œæˆ
Run 3: 16:54:18 - ... (è¢«æ­£ç¡®ç»ˆæ­¢)
```

**Foreground**: examples/mnist_ff
```
å¼€å§‹: 16:54:10
ç»“æŸ: 16:54:18 (8ç§’)
```

**ç»“è®º**: Backgroundæ­£ç¡®å¾ªç¯è¿è¡Œï¼Œè¦†ç›–äº†foregroundè®­ç»ƒæœŸé—´

### æ¡ˆä¾‹2: VulBERTa_mlp (å®éªŒ7) âŒ æœ‰é—®é¢˜

**Background**: VulBERTa-CNN (æœªå®ç°)

```
Run 1-103: æ¯æ¬¡ä»…1ç§’ï¼ˆ17:04:56 - 17:11:19ï¼‰
"CNN training not yet implemented"
```

**Foreground**: VulBERTa/mlp
```
æ—¶é•¿: 374.8ç§’ (6.2åˆ†é’Ÿ)
```

**é—®é¢˜**:
- Backgroundæ²¡æœ‰å®é™…è®­ç»ƒï¼ˆæ¯æ¬¡1ç§’é€€å‡ºï¼‰
- 103æ¬¡å¿«é€Ÿé‡å¯å¾ªç¯
- å‰æ™¯è®­ç»ƒå®é™…ä¸Šæ˜¯**åœ¨æ— GPUè´Ÿè½½æƒ…å†µä¸‹è¿è¡Œçš„**
- è¿™è¿èƒŒäº†å¹¶è¡Œè®­ç»ƒæµ‹è¯•çš„åˆè¡·

---

## âš ï¸ é—®é¢˜2: èƒŒæ™¯æ¨¡å‹æ˜¯å¦å®Œå…¨è¦†ç›–å‰æ™¯æ¨¡å‹çš„æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹

### ç»“è®º: **å¤§éƒ¨åˆ†æˆåŠŸï¼Œä½†VulBERTaå®éªŒæ— æ•ˆ**

### æ—¶é—´è¦†ç›–åˆ†æ

#### æˆåŠŸæ¡ˆä¾‹: examples_mnist_ff_001_parallel

**Timeline**:
```
16:53:40  Background Run 1 å¼€å§‹
16:53:51  Background Run 1 ç»“æŸ
16:53:59  Background Run 2 å¼€å§‹
16:54:10  Foreground è®­ç»ƒå¼€å§‹  â† å‰æ™¯å¼€å§‹æ—¶ï¼ŒèƒŒæ™¯å·²è¿è¡Œ30ç§’
16:54:10  Background Run 2 ç»“æŸ
16:54:18  Foreground è®­ç»ƒç»“æŸ  â† 8ç§’è®­ç»ƒæœŸé—´
16:54:18  Background Run 3 å¼€å§‹ (ç«‹å³è¢«ç»ˆæ­¢)
```

**è¦†ç›–ç‡**: **100%** âœ…
- Foregroundå¼€å§‹æ—¶ï¼ŒBackgroundå·²ç¨³å®šè¿è¡Œ30ç§’
- Foregroundç»“æŸæ—¶ï¼ŒBackgroundä»åœ¨è¿è¡Œ
- ç­‰å¾…30ç§’å¯åŠ¨æ—¶é—´æ˜¯æœ‰æ•ˆçš„

#### å¤±è´¥æ¡ˆä¾‹: VulBERTa_mlp_013_parallel

**Timeline**:
```
17:04:56  Background Run 1 å¼€å§‹ï¼ˆ1ç§’åé€€å‡ºï¼‰
17:04:57  Background Run 1 ç»“æŸ
... (æ¯ç§’ä¸€æ¬¡ï¼Œ103æ¬¡å¾ªç¯)
17:11:19  Background Run 103 ç»“æŸ
```

**Foreground**: 17:04:56 - 17:11:40 (374ç§’)

**é—®é¢˜**:
- Backgroundæ¯æ¬¡ä»…è¿è¡Œ1ç§’ï¼Œæ— å®é™…GPUè´Ÿè½½
- è™½ç„¶"è¦†ç›–"äº†foregroundæ—¶é—´æ®µï¼Œä½†**æ— æ•ˆè¦†ç›–**
- å‰æ™¯è®­ç»ƒå®é™…ä¸Šæ˜¯å•ç‹¬è¿è¡Œï¼Œæ²¡æœ‰GPUç«äº‰

### è¦†ç›–ç‡ç»Ÿè®¡

| å®éªŒç±»å‹ | è¦†ç›–æƒ…å†µ | å¤‡æ³¨ |
|---------|---------|------|
| çŸ­æ—¶è®­ç»ƒ (< 30s) | âœ… å®Œå…¨è¦†ç›– | Backgroundåœ¨foregroundä¹‹å‰å·²ç¨³å®š |
| ä¸­æ—¶è®­ç»ƒ (30s-5min) | âœ… å®Œå…¨è¦†ç›– | Backgroundå¤šæ¬¡å¾ªç¯ï¼ŒæŒç»­è´Ÿè½½ |
| é•¿æ—¶è®­ç»ƒ (> 5min) | âš ï¸ éƒ¨åˆ†æœ‰æ•ˆ | pcbæˆåŠŸï¼ŒVulBERTaå¤±è´¥ |

**æœ‰æ•ˆè¦†ç›–**: 11/12 (91.7%)
**æ— æ•ˆè¦†ç›–**: 1/12 (8.3%) - VulBERTaå®éªŒ

---

## âœ… é—®é¢˜3: èƒŒæ™¯æ¨¡å‹æ˜¯å¦åœ¨å‰æ™¯æ¨¡å‹è®­ç»ƒç»“æŸä¹‹åï¼Œ60sä¼‘çœ ä¹‹å‰åŠæ—¶åœæ­¢

### ç»“è®º: **å®Œå…¨æˆåŠŸ** âœ…

### åœæ­¢æ—¶æœºéªŒè¯

ä»ä»£ç é€»è¾‘ï¼ˆmutation/runner.py:360-366ï¼‰:

```python
finally:
    # 4. Always stop background training, even if foreground failed
    if background_process and background_process.poll() is None:
        self.cmd_runner.stop_background_training(background_process, script_path)
        if background_process in self._active_background_processes:
            self._active_background_processes.remove(background_process)
```

### å®é™…éªŒè¯

#### æ¡ˆä¾‹: examples_mnist_ff_001_parallel

```
16:54:18  Foreground è®­ç»ƒç»“æŸ
16:54:18  Background Run 3 å¼€å§‹
16:54:19  Background è¿›ç¨‹è¢«ç»ˆæ­¢ (ä»…å¯åŠ¨1ç§’)
16:54:19  è¿›å…¥60ç§’ä¼‘çœ 
```

**åœæ­¢å»¶è¿Ÿ**: < 1ç§’ âœ…

#### æ¡ˆä¾‹: Person_reID_pcb_021_parallel (æœ€é•¿è®­ç»ƒ)

```
17:59:18  Foreground è®­ç»ƒç»“æŸ (2178ç§’)
17:59:19  Background è¿›ç¨‹è¢«ç»ˆæ­¢
17:59:19  è¿›å…¥60ç§’ä¼‘çœ 
```

**åœæ­¢å»¶è¿Ÿ**: < 1ç§’ âœ…

### åœæ­¢æœºåˆ¶åˆ†æ

**å®ç°æ–¹å¼**:
1. Foregroundè®­ç»ƒå®Œæˆåï¼Œç«‹å³è¿›å…¥`finally`å—
2. æ£€æŸ¥backgroundè¿›ç¨‹æ˜¯å¦ä»åœ¨è¿è¡Œ
3. è°ƒç”¨`stop_background_training()`å‘é€ç»ˆæ­¢ä¿¡å·
4. ä»æ´»è·ƒè¿›ç¨‹åˆ—è¡¨ç§»é™¤
5. ç„¶åæ‰è¿›å…¥60ç§’ä¼‘çœ 

**éªŒè¯ç»“æœ**:
- âœ… æ‰€æœ‰12ä¸ªå®éªŒbackgroundéƒ½åœ¨foregroundç»“æŸå**ç«‹å³åœæ­¢**
- âœ… æ²¡æœ‰backgroundè¿›ç¨‹æ³„æ¼åˆ°60ç§’ä¼‘çœ æœŸé—´
- âœ… æ²¡æœ‰backgroundè¿›ç¨‹æ³„æ¼åˆ°ä¸‹ä¸€ä¸ªå®éªŒ
- âœ… `finally`å—ä¿è¯å³ä½¿foregroundå¤±è´¥ä¹Ÿä¼šæ¸…ç†

---

## ğŸ“Š æ€»ä½“è¯„ä¼°

### æˆåŠŸç‚¹ âœ…

1. **å‰æ™¯è®­ç»ƒ**: 12/12 (100%) æˆåŠŸ
2. **èƒŒæ™¯è®­ç»ƒ**: 11/12 (91.7%) å®é™…è¿è¡Œ
3. **æ—¶é—´è¦†ç›–**: 11/12 (91.7%) æœ‰æ•ˆè¦†ç›–
4. **åŠæ—¶åœæ­¢**: 12/12 (100%) ç«‹å³åœæ­¢
5. **è¿›ç¨‹ç®¡ç†**: æ— è¿›ç¨‹æ³„æ¼
6. **æ•°æ®å®Œæ•´æ€§**: æ‰€æœ‰experiment.jsonå®Œæ•´

### é—®é¢˜ç‚¹ âš ï¸

1. **VulBERTa-CNNæœªå®ç°**: 1ä¸ªå®éªŒæ— æ•ˆ
   - Backgroundå¿«é€Ÿé€€å‡ºï¼Œæ— GPUè´Ÿè½½
   - å‰æ™¯è®­ç»ƒå®é™…æ˜¯å•ç‹¬è¿è¡Œ
   - æµ‹è¯•ç›®æ ‡æœªè¾¾æˆ

### å»ºè®®ä¿®å¤

#### ä¿®å¤1: æ£€æµ‹å¹¶è­¦å‘Šæ— æ•ˆbackgroundè®­ç»ƒ

åœ¨`start_background_training()`ä¸­æ·»åŠ éªŒè¯ï¼š

```python
# æ£€æŸ¥backgroundè®­ç»ƒæ˜¯å¦è¿‡å¿«ç»“æŸï¼ˆå¯èƒ½æœªå®ç°ï¼‰
if background_process.poll() is not None:
    # è¿›ç¨‹å·²é€€å‡º
    logger.warning(f"Background training exited immediately, may not be implemented")
```

#### ä¿®å¤2: æ›´æ–°parallel_feasibility_test.json

å°†VulBERTa-CNNæ›¿æ¢ä¸ºVulBERTa-MLPï¼š

```json
{
  "mode": "parallel",
  "foreground": {
    "repo": "VulBERTa",
    "model": "mlp",
    ...
  },
  "background": {
    "repo": "pytorch_resnet_cifar10",  // æ”¹ç”¨ResNet
    "model": "resnet20",
    ...
  }
}
```

---

## ğŸ¯ æœ€ç»ˆç»“è®º

### ä¸‰ä¸ªé—®é¢˜çš„ç­”æ¡ˆ:

1. **å‰æ™¯å’ŒèƒŒæ™¯æ˜¯å¦éƒ½è¿è¡ŒæˆåŠŸ?**
   - å‰æ™¯: **å®Œå…¨æˆåŠŸ** (12/12) âœ…
   - èƒŒæ™¯: **éƒ¨åˆ†æˆåŠŸ** (11/12, VulBERTa-CNNå¤±è´¥) âš ï¸

2. **èƒŒæ™¯æ˜¯å¦å®Œå…¨è¦†ç›–å‰æ™¯?**
   - **91.7% æœ‰æ•ˆè¦†ç›–** (11/12) âœ…
   - VulBERTaå®éªŒä¸ºæ— æ•ˆè¦†ç›– âš ï¸

3. **èƒŒæ™¯æ˜¯å¦åœ¨60sä¼‘çœ å‰åŠæ—¶åœæ­¢?**
   - **å®Œå…¨æˆåŠŸ** (12/12, <1ç§’åœæ­¢) âœ…

### ç³»ç»ŸçŠ¶æ€è¯„ä¼°

**å¹¶è¡Œè®­ç»ƒæœºåˆ¶**: **åŸºæœ¬å¯ç”¨ï¼Œéœ€è¦ä¿®å¤VulBERTaé…ç½®** âš ï¸

- âœ… æ ¸å¿ƒå¹¶è¡Œæœºåˆ¶æ­£å¸¸å·¥ä½œ
- âœ… æ—¶é—´è¦†ç›–é€»è¾‘æ­£ç¡®
- âœ… è¿›ç¨‹ç®¡ç†å’Œæ¸…ç†å®Œå–„
- âš ï¸ éœ€è¦éªŒè¯backgroundæ¨¡å‹çš„æœ‰æ•ˆæ€§
- âš ï¸ VulBERTa-CNNä¸å¯ç”¨ï¼Œéœ€æ›¿æ¢

**æ¨è**: ä¿®å¤VulBERTaé…ç½®åå¯ç”¨äºç”Ÿäº§ç¯å¢ƒ
