## MRT-OAST for Code Clone Detection
This repository includes the code, experimental data.
### Repository structure
* ``model``: Contains trained Multiple Representation Transformer (MRT) models. 
* ``nnet``:  The ``btransform.py`` file includes the code for our Multiple Representation Transformer network.
* ``origindata``: The original OJClone/GCJ/BCB dataset we used. ``OJClone_with_AST+OAST.csv`` contains question numbers, file names, code, ASTs, and our Optimized AST (OAST). ``AST_dictionary.txt`` and ``OAST_dictionary.txt`` are the vocabularies for the two types of ASTs. The datasets of GCJ and BCB are in the same format.
* ``main_batch.py``:Entry point for executing training and testing.
* ``preprocess_data.py``:Packs the data from ``origindata`` into the model.
* ``tutils.py``:Code related to training, validation and evaluation.
* ``quick_test.py``:Code related to quick evaluation.
### Requirements
* python 3.7
* pytorch 1.13.1
* matplotlib 3.5.3
* numpy 1.21.6
* tqdm
* javalang
* GPU with CUDA support is also needed

Install pytorch according to your environment, see https://pytorch.org/

### How to use
1. ``python main_batch.py --cuda`` To train and validate the MRT model. please refer to the specific parameters in ``main_batch.py``.
2. ``python main_batch.py --cuda --is_test --quick_test`` To quick test the result on MRT model.
### About dataset
We saved the OJClone OASTs processed with the clang-based libtooling tool in ``OJClone_with_AST+OAST.csv`` , OASTs of GCJ and BCB are generated by ``oast_builder.py``. You can also use your own dataset as long as it includes AST results. We use sequences enclosed in square brackets to represent restorable ASTs. For example, for a node A with two children nodes B and C, it can be represented as``A [ B C ]``

---

## ðŸš€ Quick Start (New!)

We've added convenient training scripts and comprehensive documentation!

### One-line Quick Test
```bash
./quick_train.sh
```

### Full Training
```bash
./train_and_evaluate.sh --dataset GCJ --epochs 10
```

### ðŸ“š Documentation
All documentation is now organized in the **[docs/](docs/)** folder:

- **[Quick Start Guide](docs/QUICKSTART.md)** - Get started in minutes
- **[Environment Setup](docs/SETUP_CN.md)** - Conda environment configuration
- **[Scripts Guide](docs/SCRIPTS_GUIDE.md)** - Complete training scripts documentation
- **[Project Status](docs/PROJECT_STATUS.md)** - Full project configuration and status

### ðŸ”§ Training Scripts
- `train_and_evaluate.sh` - Main training script with full parameter control
- `quick_train.sh` - Quick training for testing
- `evaluate_model.sh` - Model evaluation script

For detailed usage, see **[docs/SCRIPTS_GUIDE.md](docs/SCRIPTS_GUIDE.md)**

### ðŸ’¡ Help
```bash
./train_and_evaluate.sh --help
```
